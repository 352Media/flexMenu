/*	jQuery.flexMenu 1.4
	https://github.com/352Media/flexMenu
	Description: If a list is too long for all items to fit on one line, display a popup menu instead.
	Dependencies: jQuery, Modernizr (optional). Without Modernizr, the menu can only be shown on click (not hover). */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function f(){(a(window).width()!==b||a(window).height()!==c)&&(a(d).each(function(){a(this).flexMenu({undo:!0}).flexMenu(this.options)}),b=a(window).width(),c=a(window).height())}function g(b){var c,d;c=a("li.flexMenu-viewMore.active"),d=c.not(b),d.removeClass("active").find("> ul").hide()}var e,b=a(window).width(),c=a(window).height(),d=[];a(window).resize(function(){clearTimeout(e),e=setTimeout(function(){f()},200)}),a.fn.flexMenu=function(b){var c,e=a.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},b);return this.options=e,c=a.inArray(this,d),c>=0?d.splice(c,1):d.push(this),this.each(function(){function t(a){var b=Math.ceil(a.offset().top)>=j+k?!0:!1;return b}var l,m,n,o,p,r,s,b=a(this),c=b.find("> li"),f=c.first(),h=c.last(),i=b.find("li").length,j=Math.floor(f.offset().top),k=Math.floor(f.outerHeight(!0)),q=!1;if(t(h)&&i>e.threshold&&!e.undo&&b.is(":visible")){var u=a('<ul class="flexMenu-popup" style="display:none;'+(e.popupAbsolute?" position: absolute;":"")+'"></ul>');f.offset().top;for(u.addClass(e.popupClass),s=i;s>1;s--){if(l=b.find("> li:last-child"),m=t(l),l.appendTo(u),s-1<=e.cutoff){a(b.children().get().reverse()).appendTo(u),q=!0;break}if(!m)break}q?b.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+e.linkTitleAll+'">'+e.linkTextAll+"</a></li>"):b.append('<li class="flexMenu-viewMore"><a href="#" title="'+e.linkTitle+'">'+e.linkText+"</a></li>"),n=b.find("> li.flexMenu-viewMore"),t(n)&&b.find("> li:nth-last-child(2)").appendTo(u),u.children().each(function(a,b){u.prepend(b)}),n.append(u),o=b.find("> li.flexMenu-viewMore > a"),o.click(function(a){g(n),u.toggle(),n.toggleClass("active"),a.preventDefault()}),e.showOnHover&&"undefined"!=typeof Modernizr&&!Modernizr.touch&&n.hover(function(){u.show(),a(this).addClass("active")},function(){u.hide(),a(this).removeClass("active")})}else if(e.undo&&b.find("ul.flexMenu-popup")){for(r=b.find("ul.flexMenu-popup"),p=r.find("li").length,s=1;p>=s;s++)r.find("> li:first-child").appendTo(b);r.remove(),b.find("> li.flexMenu-viewMore").remove()}})}});
